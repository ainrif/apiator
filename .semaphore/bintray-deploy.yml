version: v1.0
name: bintray-deploy
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804
blocks:
  - name: Deploy
    task:
      jobs:
        - name: Bintray
          commands:
            - gw build publishRelease
            - gw build publishRelease -p ./gradle-plugin/apiator-gradle-plugin
      prologue:
        commands:
          - sem-version java 11
          - sem-version node 8
          - nvm install v10.16.0
          - nvm use v10.16.0
          - 'alias gw=''./gradlew --console=plain --no-daemon'' '
          - export JS_HOME=./renderer/core-html-renderer/src/main/node/
          - checkout
